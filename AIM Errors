private FrameworkElement CreatePrintPageVisual(PrintablePage page)
{
    double pageWidth = 816;
    double pageHeight = 1056;

    var outerGrid = new Grid
    {
        Width = pageWidth,
        Height = pageHeight,
        Background = new Microsoft.UI. Xaml.Media.SolidColorBrush(Windows. UI.Color.FromArgb(255, 255, 255, 255))
    };

    var pageGrid = new Grid
    {
        Background = new Microsoft. UI.Xaml.Media. SolidColorBrush(Windows.UI.Color.FromArgb(255, 255, 255, 255)),
        Margin = new Thickness(40),
        HorizontalAlignment = HorizontalAlignment.Stretch,
        VerticalAlignment = VerticalAlignment.Stretch
    };

    pageGrid.RowDefinitions.Add(new RowDefinition { Height = GridLength.Auto });      // Row 0: Page Header
    pageGrid.RowDefinitions.Add(new RowDefinition { Height = GridLength. Auto });      // Row 1: Level2 Header
    pageGrid.RowDefinitions.Add(new RowDefinition { Height = new GridLength(1, GridUnitType. Star) }); // Row 2: Content
    pageGrid. RowDefinitions.Add(new RowDefinition { Height = GridLength.Auto });      // Row 3: Footer

    // ROW 0: PAGE HEADER (use page-specific header)
    var headerText = new TextBlock
    {
        Text = page.PageHeader ??  _viewModel?.FormData?.Header ??  string.Empty,
        FontSize = 18,
        FontWeight = Microsoft.UI.Text.FontWeights.Bold,
        Margin = new Thickness(0, 0, 0, 2),
        Foreground = new Microsoft.UI.Xaml. Media.SolidColorBrush(Windows.UI.Color. FromArgb(255, 0, 0, 0)),
        HorizontalAlignment = HorizontalAlignment.Left
    };
    Grid.SetRow(headerText, 0);
    pageGrid.Children.Add(headerText);

    // ROW 1: LEVEL 2 HEADER (section header)
    if (! string.IsNullOrEmpty(page.Level2Header))
    {
        var level2Grid = new Grid
        {
            Background = new Microsoft.UI. Xaml.Media.SolidColorBrush(Windows.UI.Color.FromArgb(255, 255, 243, 205)), // Yellow background
            Margin = new Thickness(0, 0, 0, 5),
            Padding = new Thickness(5, 3, 5, 3)
        };
        
        var level2Text = new TextBlock
        {
            Text = page.Level2Header + (page.IsContinuationPage ? " (Continued)" : ""),
            FontSize = 14,
            FontWeight = Microsoft. UI.Text.FontWeights. SemiBold,
            Foreground = new Microsoft.UI. Xaml.Media.SolidColorBrush(Windows.UI.Color.FromArgb(255, 0, 0, 0))
        };
        level2Grid.Children.Add(level2Text);
        
        Grid.SetRow(level2Grid, 1);
        pageGrid. Children.Add(level2Grid);
    }

    // ROW 2: CONTENT ROWS
    var contentPanel = new StackPanel
    {
        HorizontalAlignment = HorizontalAlignment.Stretch
    };
    
    if (page. Rows != null)
    {
        foreach (var row in page. Rows)
        {
            var rowElement = CreatePrintRowVisual(row);
            contentPanel.Children.Add(rowElement);
        }
    }
    Grid.SetRow(contentPanel, 2);
    pageGrid.Children.Add(contentPanel);

    // ROW 3: FOOTER with page number
    var footerGrid = new Grid();
    footerGrid. ColumnDefinitions.Add(new ColumnDefinition { Width = new GridLength(1, GridUnitType. Star) });
    footerGrid.ColumnDefinitions.Add(new ColumnDefinition { Width = GridLength.Auto });

    var generatedText = new TextBlock
    {
        Text = $"Generated: {_viewModel?.FormData?.Date} by {_viewModel?.FormData?.GeneratedBy}",
        FontSize = 9,
        Margin = new Thickness(0, 10, 0, 0),
        Foreground = new Microsoft. UI.Xaml.Media. SolidColorBrush(Windows.UI.Color.FromArgb(255, 128, 128, 128)),
        HorizontalAlignment = HorizontalAlignment.Left
    };
    Grid.SetColumn(generatedText, 0);
    footerGrid.Children. Add(generatedText);

    var pageNumberText = new TextBlock
    {
        Text = $"Page {page.PageNumber} of {page. TotalPages}",
        FontSize = 9,
        Margin = new Thickness(0, 10, 0, 0),
        Foreground = new Microsoft.UI. Xaml.Media.SolidColorBrush(Windows. UI.Color.FromArgb(255, 128, 128, 128)),
        HorizontalAlignment = HorizontalAlignment.Right
    };
    Grid.SetColumn(pageNumberText, 1);
    footerGrid.Children.Add(pageNumberText);

    Grid.SetRow(footerGrid, 3);
    pageGrid. Children.Add(footerGrid);

    outerGrid.Children. Add(pageGrid);

    outerGrid.Measure(new Windows.Foundation.Size(pageWidth, pageHeight));
    outerGrid.Arrange(new Windows.Foundation.Rect(0, 0, pageWidth, pageHeight));

    return outerGrid;
}
