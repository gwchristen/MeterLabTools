// Add this method to PrintableFormPage. xaml.cs
private async void ShowPaginationDebug()
{
    var log = string.Join("\n", Services.PrintPaginationService.PaginationLog);
    
    // Also show info about the current pages
    var pageInfo = new System.Text.StringBuilder();
    pageInfo.AppendLine($"Total Pages: {_viewModel?. Pages?. Count ?? 0}");
    pageInfo.AppendLine();
    
    if (_viewModel?.Pages != null)
    {
        int pageNum = 1;
        foreach (var page in _viewModel.Pages)
        {
            pageInfo.AppendLine($"=== PAGE {pageNum} ===");
            pageInfo.AppendLine($"Level2Header: {page.Level2Header}");
            pageInfo.AppendLine($"Rows: {page.Rows?. Count ?? 0}");
            
            if (page.Rows != null)
            {
                foreach (var row in page.Rows. Take(20)) // First 20 rows only
                {
                    pageInfo.AppendLine($"  [{row.Type}] {row.Content?. Substring(0, Math.Min(40, row.Content?. Length ?? 0))}");
                }
                if (page.Rows.Count > 20)
                {
                    pageInfo.AppendLine($"  ... and {page. Rows.Count - 20} more rows");
                }
            }
            pageInfo.AppendLine();
            pageNum++;
            
            if (pageNum > 6) // Only show first 6 pages
            {
                pageInfo.AppendLine("...  more pages .. .");
                break;
            }
        }
    }
    
    var dialog = new ContentDialog
    {
        Title = "Pagination Debug",
        Content = new ScrollViewer
        {
            Content = new TextBlock
            {
                Text = $"=== PAGE INFO ===\n{pageInfo}\n\n=== PAGINATION LOG ===\n{log}",
                FontFamily = new Microsoft.UI.Xaml.Media.FontFamily("Consolas"),
                FontSize = 10,
                TextWrapping = TextWrapping.NoWrap
            },
            HorizontalScrollBarVisibility = ScrollBarVisibility.Auto,
            VerticalScrollBarVisibility = ScrollBarVisibility.Auto,
            MaxHeight = 500,
            MaxWidth = 800
        },
        CloseButtonText = "OK",
        XamlRoot = this.XamlRoot
    };
    
    await dialog.ShowAsync();
}





protected override void OnNavigatedTo(NavigationEventArgs e)
{
    base.OnNavigatedTo(e);

    if (e.Parameter is PrintableForm form)
    {
        _viewModel?. LoadFormData(form);
        
        // Show debug info after UI loads
        DispatcherQueue.TryEnqueue(async () =>
        {
            await System.Threading.Tasks.Task. Delay(500);
            ShowPaginationDebug();
        });
    }

    RegisterForPrinting();
}







