    private bool IsDatabaseLockedException(SQLiteException ex)
    {
        return ex.Message.Contains("database is locked", StringComparison.OrdinalIgnoreCase) ||
               (ex.Message.Contains("locked", StringComparison.OrdinalIgnoreCase) && 
                ex.ErrorCode == SQLiteErrorCode.Locked);
    }
